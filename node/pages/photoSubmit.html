<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>stesse | submit photos</title>
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
    <link href="/styles/reset.css" rel="stylesheet">
    <link href="/styles/main.css" rel="stylesheet">
    <link href="/styles/burger.css" rel="stylesheet">
    <link href="/styles/form.css" rel="stylesheet">
    <link href="/styles/responsive.css" rel="stylesheet">
  </head>
  <body>
    <div class="wrapper"> <!--wrapper div-->
      <div> <!-- wraps header -->
        <header class="canClear">
          <div class="topbar">
            <div class="topbar-left canFade">
              <a class="topbar-left-link" id="homepage-topbar-left" href="/">
                <img class="topbar-left-logo" src="/images/topbar-stslogo-dark.png">
              </a>
            </div>
            <div id="navOverlay"></div>
            {{#burger}}{{/burger}}
          </div>
        </header>
        <div class="fixedheader-spacer" id="top"></div>
      </div> <!-- end header -->

      <main>
        <div>
          <h1>Submit To Gallery</h1>
        </div>
        <div class="photosubmit-form">
          <div class="form-container">
            <p class="form-description">To submit photos for inclusion in our photo gallery, enter direct urls to your photos in the box below. Only direct urls to <strong>.jpg</strong> files will be accepted. Please submit one photo at a time.<br><br>Note: All submissions are subject to removal from the gallery at any time. If you have questions, please feel free to <a class="inline-anchor" href="/contact">contact us</a>.</p>
            <div class="inline-input">
              <form class="inline-form stsphotosubmit" enctype="text/plain">
                <input class="inline-inputInput" type="text" name="photosubmit-input" id="photosubmit-input" placeholder="Enter image url here" required>
                <input class="submit submit-btn grn" type="submit" value="Submit">
              </form>
            </div>
          </div>
        </div>
      </main>
      <footer class="sts-footer">
        <div class="footer-logo">
          <a href="#top">
            <img src="/images/scrolltop.png">
          </a>
        </div>
        <div class="footer-links">
          <ul class="footer-links-ul">
            <li><a href="https://amazon.com" target="_blank"><p>Amazon Marketplace</p></a></li>
            <li><a href="https://twitter.com/StesseUS" target="_blank"><p>Stesse on Twitter</p></a></li>
            <li><a href="https://wedeploy.com" target="_blank"><p>WeDeploy</p></a></li>
          </ul>
        </div>
        <p class="footer-copyright">&copy; 2018 Jared Gorski</p>
      </footer>
    </div> <!--closes wrapper div-->

<script src="https://cdn.wedeploy.com/api/4.2.0/wedeploy.js"></script>
<script>
  var form = document.querySelector('.stsphotosubmit');
  form.addEventListener('submit', function(e) {
    e.preventDefault();
    let photoData = {
      message: document.getElementById('photosubmit-input').value,
    }
    let photoSubmission = "Photo Link(s): " + photoData.message;
    var imageUrl = photoData.message; var goodImage = imageUrl.includes(".jpg") || imageUrl.includes(".jpeg");
    if (goodImage) {
      WeDeploy
        .data('data-stesse.wedeploy.io')
        .create('stsdataPhotos', photoData)
        .then(function(response) {
          form.reset();
          console.info('Saved:', response);
          WeDeploy 
            .email('email-stesse.wedeploy.io')
            .auth('74550c77-dc21-4e9d-9908-75f2d960eb73')
            .from('jared.gorski@wedeploy.com')
            .to('jared.gorski@liferay.com')
            .subject("Stesse - New Photo Submission")
            .message(photoSubmission)
            .send()
            .then(function(response) {
              console.log(response);
              alert('Thank you for your submission!');
            })
            .catch(function(error) {
              console.log(error);
              alert('There was an error. Please try again!');
            });
          })
        .catch(function(error)
          {
            console.log(error);
          });
      } else {
        alert('Only direct urls to .jpg images will be accepted. Please check your url and try again.')
      }
    });
</script>
  </body>
</html>